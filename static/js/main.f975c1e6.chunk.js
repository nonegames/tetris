(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{17:function(e,t,s){},18:function(e,t,s){},19:function(e,t,s){},20:function(e,t,s){"use strict";s.r(t);var i=s(0),n=s(1),a=s.n(n),o=s(8),r=s.n(o),c=(s(17),s(2)),h=(s(18),s(19),s(6)),l=s(9),u=s(10),f={T:[[3,2,1,1,1,0,1,0],[2,3,1,0,1,1,1,0],[3,2,0,1,0,1,1,1],[2,3,0,1,1,1,0,1]],S:[[3,2,0,1,1,1,1,0],[2,3,1,0,1,1,0,1]],Z:[[3,2,1,1,0,0,1,1],[2,3,0,1,1,1,1,0]],L:[[2,3,1,0,1,0,1,1],[3,2,0,0,1,1,1,1],[2,3,1,1,0,1,0,1],[3,2,1,1,1,1,0,0]],J:[[2,3,0,1,0,1,1,1],[3,2,1,1,1,0,0,1],[2,3,1,1,1,0,1,0],[3,2,1,0,0,1,1,1]],I:[[1,4,1,1,1,1],[4,1,1,1,1,1]],O:[[2,2,1,1,1,1]]};function v(e){return Math.floor(Math.random()*e)}var b=10,d=20,p=20,j=function(){function e(){Object(l.a)(this,e),this.ctx=null,this.score=0,this.shapeN="L",this.shapeD=1,this.shapePos=[3,6],this.board=Array(200).fill(0),this.rafId=0,this.processTime=null,this.processWait=1e3,this.isFallingDown=!1,this.isPlaying=!1,this.onStart=void 0,this.onGameover=void 0,this.onScoreChange=void 0}return Object(u.a)(e,[{key:"pickShape",value:function(){var e,t=Object.keys(f),s=(e=t)[v(e.length)];this.shapeN=s,this.shapeD=v(f[s].length),this.processTime=null,this.shapePos=[v(b-f[s][this.shapeD][0]),0]}},{key:"combine",value:function(){for(var e=Object(c.a)(this.shapePos,2),t=e[0],s=e[1],i=this.shapeN,n=this.shapeD,a=Object(h.a)(f[i][n]),o=a[0],r=a[1],l=a.slice(2),u=this.board.slice(),v=s;v<s+r;v+=1)for(var d=t;d<t+o;d+=1){var p=d-t,j=v-s;u[v*b+d]=u[v*b+d]+l[j*o+p]>0?1:0}return u}},{key:"drawCeil",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.ctx;if(i){var n=e*p+1,a=t*p+1,o=19,r=19,c=2;i.save(),s?(i.fillStyle="#444",i.fillRect(n,a,o,r),i.fillStyle="#666",i.fillRect(n+c,a+c,o-2*c,r-2*c),i.fillStyle="#444",i.fillRect(n+2*c,a+2*c,o-4*c,r-4*c)):(i.fillStyle="#bbb",i.fillRect(n,a,o,r)),i.restore()}}},{key:"draw",value:function(){var e=this.ctx;if(e){e.clearRect(0,0,200,400);for(var t=this.combine(),s=0;s<d;s+=1)for(var i=0;i<b;i+=1){var n=1===t[s*b+i];this.drawCeil(i,s,n)}}}},{key:"rotate",value:function(){var e=f[this.shapeN];this.shapeD=(this.shapeD+1)%e.length;var t=Object(c.a)(f[this.shapeN][this.shapeD],2),s=t[0],i=t[1],n=Object(c.a)(this.shapePos,2),a=n[0],o=n[1];a>b-s&&(this.shapePos[0]=b-s),o>d-i&&(this.shapePos[1]=d-i)}},{key:"canMove",value:function(e){var t,s,i=Object(c.a)(this.shapePos,2),n=i[0],a=i[1],o=Object(h.a)(f[this.shapeN][this.shapeD]),r=o[0],l=o[1],u=o.slice(2),v=this.board;if(s="d"===e?a+1:a,(t="l"===e?n-1:"r"===e?n+1:n)<0||t>b-r||s>d-l)return!1;for(var p=s;p<s+l;p+=1)for(var j=t;j<t+r;j+=1){var m=j-t,O=p-s;if(v[p*b+j]*u[O*r+m]!==0)return!1}return!0}},{key:"moveX",value:function(e){this.canMove(e)&&("l"===e?this.shapePos[0]-=1:"r"===e&&(this.shapePos[0]+=1))}},{key:"moveDown",value:function(){this.canMove("d")&&(this.shapePos[1]+=1)}},{key:"fallDown",value:function(){this.isFallingDown=!0}},{key:"testGameover",value:function(){var e=Object(c.a)(this.shapePos,2),t=e[0],s=e[1];if(s>0)return!1;for(var i=Object(h.a)(f[this.shapeN][this.shapeD]),n=i[0],a=i[1],o=i.slice(2),r=s;r<s+a;r+=1)for(var l=t;l<t+n;l+=1){var u=l-t,v=r-s;if(this.board[r*b+l]*o[v*n+u]!==0)return!0}return!1}},{key:"dealScore",value:function(){for(var e=this,t=[],s=0;s<d;s+=1){for(var i=1,n=0;n<b;n+=1)i*=this.board[s*b+n];i>0&&t.push(s)}t.length>0&&(this.score+=10*t.length,this.onScoreChange&&this.onScoreChange.call(void 0,this.score),t.reverse().forEach((function(t){e.board.splice(t*b,b)})),this.board=Array(t.length*b).fill(0).concat(this.board))}},{key:"loop",value:function(e){var t=this;this.rafId=requestAnimationFrame((function(e){return t.loop(e)})),this.process(e)}},{key:"process",value:function(e){this.testGameover()?this.gameover():(null===this.processTime?this.processTime=e:(this.isFallingDown||e-this.processTime>=this.processWait)&&(this.processTime=e,this.canMove("d")?this.shapePos[1]+=1:(this.board=this.combine(),this.dealScore(),this.pickShape(),this.isFallingDown&&(this.isFallingDown=!1))),this.draw())}},{key:"start",value:function(){var e=this;this.isPlaying=!0,this.board.fill(0),this.score=0,this.isFallingDown=!1,this.pickShape(),this.rafId=requestAnimationFrame((function(t){return e.loop(t)})),this.onStart&&this.onStart.call(void 0)}},{key:"gameover",value:function(){this.isPlaying=!1,cancelAnimationFrame(this.rafId),this.onGameover&&this.onGameover.call(void 0)}}]),e}(),m=function(e){var t=e.game,s=e.isGameover;return Object(i.jsxs)("div",{className:"popup-box",children:[s?Object(i.jsx)("div",{className:"gameover-msg",children:"GAME OVER"}):null,Object(i.jsx)("button",{id:"btnStart",onClick:function(){t.start()},children:s?"TRY AGAIN":"START GAME"})]})},O=s(11),g=s.n(O),k=new j;var w=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(!1),s=Object(c.a)(t,2),a=s[0],o=s[1],r=Object(n.useState)(!1),h=Object(c.a)(r,2),l=h[0],u=h[1],f=Object(n.useState)(0),v=Object(c.a)(f,2),b=v[0],d=v[1];return Object(n.useEffect)((function(){var t;k.ctx=null===(t=e.current)||void 0===t?void 0:t.getContext("2d"),k.onStart=function(){u(!0)},k.onGameover=function(){u(!1),o(!0)},k.onScoreChange=d,k.draw()}),[]),Object(n.useEffect)((function(){var e=function(e){switch(e.preventDefault(),g()(e)){case"left":case"a":k.moveX("l");break;case"right":case"d":k.moveX("r");break;case"down":case"s":k.moveDown();break;case"up":case"w":case"r":k.rotate();break;case"enter":case"space":k.isPlaying?k.fallDown():k.start()}};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]),Object(i.jsxs)("div",{className:"App",children:[Object(i.jsxs)("header",{children:[Object(i.jsx)("span",{className:"score-label",children:"SCORE: "}),Object(i.jsx)("span",{className:"score-value",children:b})]}),Object(i.jsxs)("section",{children:[Object(i.jsx)("canvas",{id:"game-renderer",width:201,height:401,ref:e}),l?null:Object(i.jsx)(m,{game:k,isGameover:a})]}),Object(i.jsxs)("footer",{children:[Object(i.jsx)("button",{className:"iconfont icon-arrow-left",onClick:function(){return k.moveX("l")}}),Object(i.jsx)("button",{className:"iconfont icon-arrow-down",onClick:function(){return k.moveDown()}}),Object(i.jsx)("button",{className:"iconfont icon-arrow-right",onClick:function(){return k.moveX("r")}}),Object(i.jsx)("span",{children:"\xa0\xa0"}),Object(i.jsx)("button",{className:"iconfont icon-arrow-bottom",onClick:function(){return k.fallDown()}}),Object(i.jsx)("button",{className:"iconfont icon-arrow-rotate",onClick:function(){return k.rotate()}})]})]})},y=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,21)).then((function(t){var s=t.getCLS,i=t.getFID,n=t.getFCP,a=t.getLCP,o=t.getTTFB;s(e),i(e),n(e),a(e),o(e)}))};r.a.render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(w,{})}),document.getElementById("root")),y()}},[[20,1,2]]]);
//# sourceMappingURL=main.f975c1e6.chunk.js.map